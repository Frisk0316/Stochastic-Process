# 隨機過程 HW3 

### 1. Simulate the process of the moving particle until all nodes are visited

以下分別是以 0 為起點, 執行 100, 1000, 10000, 及 100000 次的結果

**100 次**

![100](https://github.com/Frisk0316/Stochastic-Process/assets/79501315/a79dca11-8d4c-4cbd-b06a-3287a1533c82)

**1,000 次**

![1000](https://github.com/Frisk0316/Stochastic-Process/assets/79501315/6cb1e029-22f4-4cb0-aa39-c66dcd42e656)

**10,000 次**

![10000](https://github.com/Frisk0316/Stochastic-Process/assets/79501315/0a99d3bf-bd30-46b2-a9d5-fc5e2c00aa58)

**100,000 次**

![100000](https://github.com/Frisk0316/Stochastic-Process/assets/79501315/0f6534f7-c992-419b-9878-f68e9eb65f90)

隨著次數越多，我們可以發現每個節點為終點的機率越來越趨近於一致，亦即若有 0 ~ n 個節點，並以 0 號做為起點，其餘節點 (1 ~ n) 為終點的機率為 1/n 

### 2. 證明

從 1. 可以得到結論, 當起點為 i ( i = 0, 1, ..., m) , 終點為 k ( k = 0, 1, ..., m, k != i ) 的機率為 $\frac{1}{m}$

而該機率不受起點的影響, 因此
P(i is the last | i + 1 is visited first) = $\frac{1}{m}$

又 P(down m - 1 before up 1 ) = $\frac{1}{m}$

兩者機率相等

### 3. Gambler’s ruin problem

#### (1) p = q = 0.5

| 模擬次數 (times) | 起始金額 (n) | 需要贏得的金額 (k) | 獲勝機率 (p) | 獲勝次數 (總金額達到 n+k) | 輸掉的次數 (總金額達到 0) | P(up k before down n) | $\frac{n}{n+k}$  |
|---|---|---|---| --- | ---| --- | --- |
| 10,000 | 100 | 10 | 0.5 | 9,115 | 885 | 0.9115 | 0.9091 |
| 10,000 | 100 | 20 | 0.5 | 8,240 | 1,760 | 0.8240 | 0.8333 |
| 10,000 | 100 | 50 | 0.5 | 6,692 | 3,308 | 0.6692 | 0.6667 |
| 10,000 | 100 | 100 | 0.5 | 4,961 | 5,039 | 0.4961 | 0.5000 |
| 10,000 | 100 | 200 | 0.5 | 3,342 | 6,658 | 0.3342 | 0.3333 |

當 p = 0.5, P( up k before down n ) 會趨近於 $\frac{n}{n+k}$

#### (2) p = 0.6, q = 0.4

| 模擬次數 (times) | 起始金額 (n) | 需要贏得的金額 (k) | 獲勝機率 (p) | 獲勝次數 (總金額達到 n+k) | 輸掉的次數 (總金額達到 0) | P(up k before down n) | $\frac{n}{n+k}$  |
|---|---|---|---| --- | ---| --- | --- |
| 10,000 | 100 | 20 | 0.6 | 10,000 | 0 | 1.0000 | 0.8333 |
| 10,000 | 100 | 50 | 0.6 | 10,000 | 0 | 1.0000 | 0.6667 |
| 10,000 | 100 | 100 | 0.6 | 10,000 | 0 | 1.0000 | 0.5000 |

當 p = 0.6, P( up k before down n ) = 1

### 4. Brownian Motion 

#### (a) ∆t 的差異

∆t 會影響到每單位 ∆t 變動的變異數, 當 ∆t 越大, 則變異越大, 其模擬的結果就可能越偏離理想機率

#### (b) 模擬

執行結果範例:

```
Start with 0
end with 1 for 643 times
end with -2 for 357 times
P(up A( 1 ) before down B( 2 )) = 0.643
```

結果:

| A | B | ∆t | times | P(up A before down B) | $\frac{B}{A+B}$ |
| --- | --- | --- | --- | --- | --- |
| 1 | 2 | 0.01 | 1,000| 0.645 | 0.6667 |
| 1 | 2 | 0.01 | 1,000| 0.671 | 0.6667 |
| 1 | 2 | 0.01 | 1,000| 0.656 | 0.6667 |
| 1 | 2 | 0.01 | 1,000| 0.677 | 0.6667 |
| 1 | 2 | 0.01 | 1,000| 0.678 | 0.6667 |
| 1 | 2 | 0.1 | 1,000| 0.624 | 0.6667 |
| 1 | 2 | 0.1 | 1,000| 0.656 | 0.6667 |
| 1 | 2 | 0.1 | 1,000| 0.641 | 0.6667 |
| 1 | 2 | 0.1 | 1,000| 0.669 | 0.6667 |
| 1 | 2 | 0.1 | 1,000| 0.646 | 0.6667 |
| 1 | 2 | 1 | 1,000| 0.643 | 0.6667 |
| 1 | 2 | 1 | 1,000| 0.637 | 0.6667 |
| 1 | 2 | 1 | 1,000| 0.630 | 0.6667 |
| 1 | 2 | 1 | 1,000| 0.655 | 0.6667 |
| 1 | 2 | 1 | 1,000| 0.638 | 0.6667 |

當 ∆t 越小, 其機率模擬地較為接近理想機率(2/3), 反之當 ∆t 越大, 機率的變異就越大
